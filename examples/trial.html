<html>
<head><title>Connect on Demand</title></head>

<body>
<script src="lib/samp.js"></script>
<script>
var connector = new samp.Connector("Sender");
var msg = new samp.Message("table.load.votable",
                           {"url": "file:///mbt/data/table/messier.xml"});
var send = function() {
    connector.runWithConnection(function(conn) {
        conn.notifyAll([msg]);
    });
};
var sbutt = undefined;
configureSampEnabled = function(isConnected) {
    sbutt.disabled = !isConnected;
};
onload = function() {
    sbutt = document.getElementById("sendButt");
    sbutt.disabled = true;
    connector.onHubAvailability(configureSampEnabled, 2000);
};
</script>

<h2>Connect on Demand</h2>

<button id="sendButt" type="button" onclick="send()">Send</button>

</body>
</html>
